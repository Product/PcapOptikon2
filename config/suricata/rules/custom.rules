alert smb any any -> $HOME_NET any (msg:"CertegoAttack Discovery Possible ETERNALBLUE MS17-010 probing Success Response"; flow:to_client,established; flowbits:isset,ETERNALBLUE.PROBING; content:"|00|"; depth:1; content:"|53 4d 42 25 05 02 00 c0|"; distance:4; within:8; fast_pattern; reference:url,https://github.com/certego/attack_techniques/tree/master/attack_techniques/killchain/discovery/cve/ms17-010; classtype:successful-recon-limited; sid:9000306; rev:1;)
alert smb any any -> $HOME_NET any (msg:"CertegoAttack Discovery Possible ETERNALBLUE MS17-010 probing Failure Response; flow:to_client,established; flowbits:isset,ETERNALBLUE.PROBING; content:"|00|"; depth:1; content:"|53 4d 42 25|"; distance:4; within:4; fast_pattern; pcre:"/(\x08|\x22)\x00\x00\xc0/"; reference:url,https://github.com/certego/attack_techniques/tree/master/attack_techniques/killchain/discovery/cve/ms17-010; classtype:failed-recon-limited; sid:9000305; rev:1;)
alert smb any any -> $HOME_NET any (msg:"CertegoAttack Discovery Possible ETERNALBLUE MS17-010 probing Request"; flow:to_server,established; content:"|00|"; depth:1; content:"|53 4d 42 25|"; distance:4; within:4; fast_pattern; content:"|00 00 00 00 ff ff ff ff 00 00 00 00 00 00 00 00 00 00 00 00 4a 00 00 00 4a 00 02 00 23 00 00 00 07 00 5c 50 49 50 45 5c|"; within:68; flowbits:set,ETERNALBLUE.PROBING; reference:url,https://github.com/certego/attack_techniques/tree/master/attack_techniques/killchain/discovery/cve/ms17-010; classtype:attempted-recon; sid:9000304; rev:1;)